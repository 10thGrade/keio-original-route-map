# keio-original-route-map

京王線の路線図をカスタマイズして作成できるWebアプリケーション。各駅の停車列車種別を設定し、オリジナルの路線図をSVG/PNG形式で出力できる。

## 機能

- **駅ごとの停車列車種別設定**: 各駅で各停・快速・区間急行・急行・特急の停車設定を変更可能
- **リアルタイム描画**: 設定変更に応じて路線図が即座に更新
- **データのインポート/エクスポート**: CSV形式で駅データの保存・読み込みが可能
- **路線図のエクスポート**: SVG形式またはPNG形式で路線図を保存
- **インタラクティブな操作**: マウスドラッグで移動、ホイールでズーム

## 対応路線

- **京王本線**: 新宿 〜 京王八王子(34駅)
- **相模原線**: 京王多摩川 〜 橋本(11駅)
- **高尾線**: 京王片倉 〜 高尾山口(6駅)
- **井の頭線**: 渋谷 〜 吉祥寺(17駅)

## 使い方

### 基本的な操作フロー

1. **路線図の表示**: アプリを開くと、本来の路線図が表示される
2. **停車種別の変更**: 左側のサイドバーから各駅のスライダーを操作して、停車列車種別を変更
   - スライダーを右に動かすと上位種別(特急)が停車
   - スライダーを左に動かすと下位種別(各停)のみ停車
3. **路線図の操作**:
   - **移動**: マウスでドラッグ
   - **ズーム**: マウスホイールで拡大・縮小
   - **ビュー初期化**: 右下のリセットボタンをクリック
4. **データの保存・読み込み**:
   - **CSV保存**: CSV保存ボタンで現在の設定をCSVファイルとして保存
   - **CSV読込**: CSV読込ボタンで保存したCSVファイルを読み込み
5. **路線図のエクスポート**:
   - **SVG保存**: ベクター形式で保存
   - **PNG保存**: ラスター形式で保存

### CSVファイル形式

CSVファイルは以下の形式で保存されます：

```csv
id,name,num,dist,rank,group
shinjuku,新宿,1,0,5,keio
hatsudai,初台,2,70,4,keio
...
```

| カラム | 説明 |
|--------|------|
| `id` | ID(英数字) |
| `name` | 駅名(日本語) |
| `num` | 駅番号 |
| `dist` | 前の駅からの距離(px) |
| `rank` | 停車列車種別(1:各停, 2:快速, 3:区間急行, 4:急行, 5:特急) |
| `group` | 路線グループ(`keio`, `sagami`, `takao`, `ino`) |

## ファイル構成

```
keio-original-route-map/
├── index.html
├── styles.css
├── script.js
└── README.md
```

### 主要な関数

#### 路線図描画
- `drawMap()`: 路線図全体を描画
- `drawInokashiraLine()`: 井の頭線を描画
- `calculateGeometry()`: 駅の位置を計算

#### データ操作
- `exportCSV()`: CSV形式でデータをエクスポート
- `importCSV()`: CSVファイルを読み込み
- `updateRank()`: 駅の停車種別を更新

#### エクスポート
- `downloadSVG()`: SVG形式で路線図を保存
- `downloadPNG()`: PNG形式で路線図を保存

#### 操作
- `initPanZoom()`: パン・ズーム機能の初期化
- `resetView()`: ビューをリセット

## 技術スタック

- **HTML5**: ページ構造
- **CSS3**: スタイリング
- **JavaScript (Vanilla JS)**: ロジック実装
- **SVG**: 路線図の描画

## 列車種別と色

| 種別 | 色 | ランク |
|------|-----|--------|
| 各停 | `#818285` (グレー) | 1 |
| 快速 | `#0F4E8C` (ブルー) | 2 |
| 区間急行 | `#CFBC30` (イエロー) | 3 |
| 急行 | `#05B08D` (ティール) | 4 |
| 特急 | `#CA2D73` (マゼンタ) | 5 |

## ブラウザ対応

モダンブラウザ(Chrome、Firefox、Safari、Edge)の最新版を推奨。

## ライセンス

MIT
